---
layout: post
title: How Syntax Highlighting Works in Jekyll
categories: [jekyll, blog, syntax-highlighting]
tags: [rouge, jekyll, syntax-highlighting, css, markdown]
author: CoderCollie
---

Recently, I applied syntax highlighting to my Jekyll-based blog. When I looked at the CSS file required for syntax highlighting, I noticed it only contained unfamiliar classes like the ones below. I expected to see keywords like "ruby" or "python" or something similar—classes that would indicate which syntax to highlight and which keywords should be emphasized. Instead, there were only some classes I wasn't familiar with.

```css
.highlight .k { color: #d73a49; }  /* Keywords */
.highlight .kd { color: #d73a49; } /* Keywords */
```

This made me realize I needed to understand how syntax highlighting actually works in Jekyll.

## The Complete Process

Syntax highlighting works in three main steps:

1. **Jekyll and Rouge convert markdown files to HTML**
2. **Rouge determines which words should be highlighted and assigns appropriate CSS classes**
3. **The web browser applies syntax highlighting to elements based on their classes**

## 1. Converting Markdown to HTML

Below is an example of how Jekyll and Rouge convert markdown code to HTML:

`````````markdown
```lua
function test()
    return "hello"
end
```
`````````

Gets converted to:

```html
<div class="language-lua highlighter-rouge">
  <div class="highlight">
    <pre class="highlight">
      <code>
        <span class="k">function</span> <span class="nf">test</span><span class="p">()</span>
        <span class="w">    </span><span class="k">return</span> <span class="s2">"hello"</span>
        <span class="k">end</span>
      </code>
    </pre>
  </div>
</div>
```

## 2. Rouge Understands Programming Languages

Rouge knows how to categorize keywords into different classes.

As you might know, some words can be keywords in programming language A but not in programming language B. Different programming languages have different syntax and keywords.

- **Lua**: `function`, `return`, `end` → keywords
- **Python**: `def`, `return`, `if` → keywords
- **JavaScript**: `function`, `return`, `if` → keywords

The most important thing is that Rouge can distinguish which words are keywords depending on the programming language.

```html
<!-- Lua code -->
<span class="k">function</span> <span class="nf">test</span><span class="p">()</span>

<!-- Python code -->
<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>

<!-- JavaScript code -->
<span class="k">function</span> <span class="nf">test</span><span class="p">()</span>
```

### CSS Classes Generated by Rouge

- `k`: **Keywords** (function, if, return, etc.)
- `nf`: **Method or function names** (test, swapEscAndBacktick, etc.)
- `s`: **Strings** ("hello", 'world', etc.)
- `c`: **Comments** (--, //, #, etc.)
- `n`: **Variable names** (keyCode, event, etc.)
- `o`: **Operators** (=, +, -, etc.)
- `mi`: **Numbers** (53, 100, etc.)
- `p`: **Parentheses** ((), {}, [], etc.)

## 3. CSS Doesn't Need to Know the Syntax

Since Rouge has already distinguished the type of each word and attached the appropriate class, CSS doesn't need to understand the syntax.

```css
/* Apply red color to all keywords */
.highlight .k { color: #d73a49; }

/* Apply blue color to all strings */
.highlight .s { color: #032f62; }

/* Apply gray color to all comments */
.highlight .c { color: #6a737d; }
```

By applying this CSS, we can see syntax-highlighted code in the web browser like this:

```html
<!-- Lua, Python, JavaScript all use the same color scheme -->
<span class="k">function</span>  <!-- Red -->
<span class="s">"hello"</span>  <!-- Blue -->
<span class="c">-- comment</span>   <!-- Gray -->
```

---

## Related Links

- [Rouge Official Documentation](https://github.com/rouge-ruby/rouge)
- [Jekyll Syntax Highlighting](https://jekyllrb.com/docs/liquid/tags/#code-syntax-highlighting)
